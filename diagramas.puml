@startuml

!pragma layout smetana
!define JAVA_STYLE

abstract class Simulator {
  + {abstract} create(file_name_args: String): Simulator
  + {abstract} listAgents(): List[Agents]
  + {abstract} execute(): void
}

class SimulatorMotor {
  - time_limit: int
  - time_per_step: double
  - running: bool
  - world: World
  + shutDownSimulation(): void
  + saveResults(fileName: String): void
  + saveState(): void
}

abstract class Agent {
  + {abstract} create(fileNameArgs: String): Agent
  + {abstract} observe(observation: Observation): void
  + {abstract} act(): Action
  + {abstract} evaluateCurrentState(reward: double)
  + {abstract} install(sensor: Sensor): void
  + {abstract} execute(): void
}

class ExplorerAgent {
  - id: int
  - position: tuple
  - learn_mode: boolean
  - steps: steps
  - genotype: List[Action]
  - sensor: Sensor
  - observation: set
  - step_index: int
  - inventory: List
  - behavior: set
  - path: List
  - reward: int
  - noveltyScore: double
  - combinedFitness: double
}

class Chicken {
}

enum Action {
  MOVE_NORTH = (0, 1)
  MOVE_SOUTH = (0, -1)
  MOVE_WEST = (-1, 0)
  MOVE_EAST = (1, 0)
  ---
  + random_action(): tuple
}

enum Direction {
  NORTH = (0, 1)
  SOUTH = (0, -1)
  WEST  = (-1, 0)
  EAST  = (1, 0)
  NORTH_EAST = (1, 1)
  NORTH_WEST = (-1, 1)
  SOUTH_EAST = (1, -1)
  SOUTH_WEST = (-1, -1)
}

abstract class Environment {
  + {abstract} observationFor(explorer: ExplorerAgent): Observation
  + {abstract} update(): void
  + {abstract} act(action: Action, agent: Agent): void
}

class World {
  - width: int
  - height: int
  - solved: boolean
  - map: List[List]
  - agents: List[Chicken]
  - eggs: List[Egg]
  - nests: List[Nest]
  - stones: List[Stone]
  + initializeMap(numEggs: int, numNests: int, numChickens: int): void
  + is_valid_action(action_to_validate: Action, explorer_pos: tuple): boolean
}

class ForagingWorld {
}

class LightHouseWorld {
}

class Observation {
  - agent_id: int
  - possible_actions: List
  + total_possible_actions(): int
}

class Wall {
}

abstract class Item {
  # name: String
  # id: int
  # position: tuple
}

class Pickable {
  - picked_up: boolean
  + pickUp(): void
  + drop(): void
}

class Nest {
  - capacity: int
  - eggs: int
  + putEgg(numEggs: int): boolean
}

class Egg {
}

class ChickenCoop {
}

class Stone {
  - weight: int
}

class Sensor {
  - world: World
  - height: int
  - width: int
  - max_range: int
  + get_observation(agent_pos): Map
  + _cast_ray(start_pos: tuple, step_vector: tuple)
}


'TODO - check class relations !

Simulator <|-- SimulatorMotor
SimulatorMotor "1" -- "1" World

Environment <|-- World
World <|-- ForagingWorld
World <|-- LightHouseWorld
World "1" -- "0..*" Item

Agent <|-- ExplorerAgent
ExplorerAgent "1..*" -- "1" World
ExplorerAgent "1" -- "0, 1" Sensor
ExplorerAgent <|-- Chicken
ExplorerAgent "1" -- "0, 1" Observation

Item <|--- Wall
Item <|-- Pickable
Item <|-- ChickenCoop
Item <|-- Nest

Pickable <|-- Egg
Pickable <|-- Stone

Direction --> Sensor
Action --> ExplorerAgent

@enduml